<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>AWS Elastic Load Balancing - Anand vyas</title>
    <meta content="AWS Elastic Load Balancing - Anand vyas" property="og:title">
    <meta content="" name="keywords">
    <meta content="" property="og:description">
    <meta name="author" content="Anand Vyas">

    
    <link href="http://localhost:4000/css/bootstrap.min.css" rel="stylesheet">
    
    <link href="http://localhost:4000/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    
    <link href="http://localhost:4000/css/highlighter.css" rel="stylesheet">
    
    <link href="http://localhost:4000/css/sb-admin.css" rel="stylesheet">
    <link href="http://localhost:4000/css/about.css" rel="stylesheet">

    <script src="http://localhost:4000/js/jquery.min.js"></script>
</head>
<body class="fixed-nav sticky-footer bg-dark sidenav-toggled" id="page-top">
  
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top" id="mainNav">
    <a class="navbar-brand" href="http://localhost:4000/">
        <img src="http://localhost:4000/images/profile/logo.png" />
        <span>Anand vyas</span>
    </a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive"
        aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav navbar-sidenav">
            <li class="nav-item sidebar-profile text-center">
                <div class="profile-pic">
                    <img src="http://localhost:4000/images/profile/avatar.jpg" alt="avatar">
                </div>
                <div class="profile-detail">
                    
                    <span>Solution Architect</span> 
                    <span>Cloud Architect</span> 
                    <span>DevOps</span> 
                    <span>Tech Lead</span> 
                </div>
            </li>
            
            <li class="nav-item sidebar-menu" data-toggle="tooltip" data-placement="right" title="Home">
                <a class="nav-link" href="http://localhost:4000/">
                <i class="fa fa-fw fa fa-home"></i>
                <span class="nav-link-text">Home</span>
                </a>
            </li>
            
            <li class="nav-item sidebar-menu" data-toggle="tooltip" data-placement="right" title="About">
                <a class="nav-link" href="http://localhost:4000/about">
                <i class="fa fa-fw fa fa-user-circle"></i>
                <span class="nav-link-text">About</span>
                </a>
            </li>
            
            <li class="nav-item sidebar-menu" data-toggle="tooltip" data-placement="right" title="Categories">
                <a class="nav-link" href="http://localhost:4000/categories">
                <i class="fa fa-fw fa fa-dashboard"></i>
                <span class="nav-link-text">Categories</span>
                </a>
            </li>
            
            <li class="nav-item sidebar-menu" data-toggle="tooltip" data-placement="right" title="Tags">
                <a class="nav-link" href="http://localhost:4000/tags">
                <i class="fa fa-fw fa fa-tags"></i>
                <span class="nav-link-text">Tags</span>
                </a>
            </li>
            
        </ul>
        <ul class="navbar-nav sidenav-social">
            
            <li><a href="#" target="_blank"><i class="fa fa-mobile"></i></a></li>
            
            <li><a href="mailto:anandvyas@live.com" target="_blank"><i class="fa fa-envelope"></i></a></li>
            
            <li><a href="https://twitter.com/anandvyaas" target="_blank"><i class="fa fa-twitter"></i></a></li>
            
            <li><a href="https://www.linkedin.com/in/anandvyaas" target="_blank"><i class="fa fa-linkedin"></i></a></li>
            
            <li><a href="https://www.instagram.com/anandvyaas" target="_blank"><i class="fa fa-instagram"></i></a></li>
            
            <li><a href="https://github.com/anandvyas" target="_blank"><i class="fa fa-github"></i></a></li>
            
            <li><a href="https://stackoverflow.com/users/8208060/anand-vyas" target="_blank"><i class="fa fa-stack-overflow"></i></a></li>
            
        </ul>
        <ul class="navbar-nav sidenav-toggler">
            <li class="nav-item">
                <a class="nav-link text-center" id="sidenavToggler">
            <i class="fa fa-fw fa-angle-left"></i>
            </a>
            </li>
        </ul>
        
        
    </div>
</nav>
  
  <div class="content-wrapper">
    <div class="container-fluid">
    


<ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="http://localhost:4000/">Home</a></li>


    
    <li class="breadcrumb-item active"><a href='http://localhost:4000/aws'>aws</a></li>
    
    


    
    <li class="breadcrumb-item active"><a href='http://localhost:4000/aws/aws-elastic-load-balancing'>aws-elastic-load-balancing</a></li>
    
    


    

</ol>

        <div class="post">
            <h1>AWS Elastic Load Balancing</h1>
            <span class="post-date">Tue, Jul 25, 2017</span>
            <p>Elastic Load Balancing automatically distributes your incoming application traffic across multiple targets, such as EC2 instances. It monitors the health of registered targets and routes traffic only to the healthy targets.</p>

<div class="text-center">
    <img class="img-responsive" src="http://localhost:4000/images/aws/aws-elb.png" alt="AWS Elastic Load Balancing" />
</div>
 

<ul>
<li>ELB serves as a single point of contact to the client</li>
<li>Elastic Load Balancer, by default, routes each request independently to the registered instance with the smallest load.</li>
<li>ELB helps to being transparent and increases the application availability by allowing addition or removal of multiple EC2 instances across one or more availability zones, without disrupting the overall flow of information.</li>
<li>If an EC2 instance fails, ELB automatically reroutes the traffic to the remaining running healthy EC2 instances. If a failed EC2 instance is restored, Elastic Load Balancing restores the traffic to that instance.</li>
<li><strong>Load Balancers only work across AZs within a region</strong></li>
</ul>

<div class="text-center">
    <img class="img-responsive" src="http://localhost:4000/images/aws/aws-elb-1.png" alt="AWS Elastic Load Balancing" />
</div>
 

<ul>
<li>Elastic Load Balancing supports routing and load balancing of Hypertext Transfer Protocol (HTTP), Hypertext Transfer Protocol Secure (HTTPS), Transmission Control Protocol (TCP), and Secure Sockets Layer (SSL) traffic to Amazon EC2 instances.</li>
<li>Elastic Load Balancing provides a stable, single Canonical Name record (CNAME) entry point for Domain Name System (DNS) configuration and supports both Internet-facing and internal application-facing load balancers.</li>
<li>Elastic Load Balancing supports health checks for Amazon EC2 instances to ensure traffic is not routed to unhealthy or failing instances. Also, Elastic Load Balancing can automatically scale based on collected metrics.</li>
<li>Elastic Load Balancing is a managed service, it scales in and out automatically to meet the demands of increased application traffic and is highly available within a region itself as a service.</li>
<li>Elastic Load Balancing seamlessly integrates with the Auto Scaling service to automatically scale the Amazon EC2 instances behind the load balancer.</li>
<li>Elastic Load Balancing is secure, working with Amazon Virtual Private Cloud (Amazon VPC) to route traffic internally between application tiers, allowing you to expose only Internet-facing public IP addresses.</li>
<li>Elastic Load Balancing also supports integrated certificate management and SSL termination.</li>
</ul>

<h3 id="a-name-aws-elb-types-elb-types-a"><a name="#aws-elb-types">ELB Types</a></h3>

<p>Elastic Load Balancing provides several types of load balancers for handling different kinds of connections including</p>

<ul>
<li>Internet-facing</li>
<li>Internal</li>

<li><p>Load balancers that support encrypted connections.</p></li>

<li><p><strong>Internet-Facing Load Balancers</strong></p>

<ul>
<li>An Internet-facing load balancer is, as the name implies, a load balancer that takes requests from clients over the Internet and distributes them to Amazon EC2 instances that are registered with the load balancer.</li>
<li>Elastic Load Balancing in Amazon VPC supports IPv4 addresses only</li>
<li>Elastic Load Balancing in EC2-Classic supports both IPv4 and IPv6 addresses.</li>
</ul></li>
</ul>

<blockquote>
<p>An AWS recommended best practice is always to reference a load balancer by its DNS name, instead of by the IP address of the load balancer, in order to provide a single, stable entry point.</p>
</blockquote>

<ul>
<li><p><strong>Internal Load Balancer</strong>: Internal load balancer routes traffic to EC2 instances in private subnets. In a multi-tier application, it is often useful to load balance between the tiers of the application.</p></li>

<li><p><strong>HTTPS Load Balancers</strong></p>

<ul>
<li>You can create a load balancer that uses the SSL/Transport Layer Security (TLS) protocol for encrypted connections (also known as SSL offload).</li>
<li>This feature enables traffic encryption between your load balancer and the clients that initiate HTTPS sessions, and for connections between your load balancer and your back-end instances.</li>
<li>In order to use SSL, you must install an SSL certificate on the load balancer that it uses to terminate the connection and then decrypt requests from clients before sending requests to the back-end Amazon EC2 instances.</li>
<li>Elastic Load Balancing does not support Server Name Indication (SNI) on your load balancer. This means that if you want to host multiple websites on a fleet of Amazon EC2 instances behind Elastic Load Balancing with a single SSL certificate, you will need to add a Subject Alternative Name (SAN) for each website to the certificate to avoid site users seeing a warning message when the site is accessed.</li>
</ul></li>
</ul>

<h3 id="a-name-aws-elb-listeners-elb-listeners-a"><a name="#aws-elb-listeners">ELB Listeners</a></h3>

<ul>
<li>Every load balancer must have one or more listeners configured. A listener is a process that checks for connection requests.</li>
<li>Listeners are configured with a protocol and a port for front-end (client to load balancer) connections, and a protocol and a port for back-end (load balancer to back-end instance) connections.</li>
<li>Elastic Load Balancing supports the following protocols:

<ul>
<li>HTTP</li>
<li>HTTPS</li>
<li>TCP</li>
<li>SSL</li>
</ul></li>
<li>Elastic Load Balancing supports protocols operating at two different Open System
Interconnection (OSI) layers.

<ul>
<li><strong>Layer 4</strong> is the transport layer that describes the TCP connection between the client and your back-end instance through the load balancer. Layer 4 is the lowest level that is configurable for your load balancer.</li>
<li><strong>Layer 7</strong> is the application layer that describes the use of HTTP and HTTPS connections from clients to the load balancer and from the load balancer to your back-end instance.</li>
</ul></li>
<li>The SSL protocol is primarily used to encrypt confidential data over insecure networks such as the Internet. The SSL protocol establishes a secure connection between a client and the back-end server and ensures that all the data passed between your client and your server is private.</li>
</ul>

<h3 id="a-name-aws-elb-configuring-elb-configuring-a"><a name="#aws-elb-configuring">ELB Configuring</a></h3>

<ul>
<li>Elastic Load Balancing allows you to configure many aspects of the load balancer, including

<ul>
<li>idle connection timeout</li>
<li>cross-zone load balancing</li>
<li>connection draining</li>
<li>proxy protocol</li>
<li>sticky sessions</li>
<li>health checks.</li>
</ul></li>

<li><p>Configuration settings can be modified using either the AWS Management Console or a Command Line Interface (CLI).</p></li>

<li><p><strong>idle connection timeout</strong></p>

<ul>
<li>For each request that a client makes through a load balancer, it maintains two connections, for each client request, one connection with the client and the other connection is to the back-end instance.</li>
<li>For each connection, the load balancer manages an idle timeout that is triggered when no data is sent over the connection for a specified time period. If no data has been sent or received, it closes the connection after the idle timeout period <strong>(defaults to 60 seconds)</strong> has elapsed</li>
<li>For lengthy operations, such as file uploads, the idle timeout setting for the connections should be adjusted to ensure that lengthy operations have time to complete.</li>
</ul></li>

<li><p><strong>Cross-Zone Load Balancing</strong></p>

<ul>
<li>By default, the load balancer distributes incoming requests evenly across its enabled Availability Zones for e.g. If AZ-a has 5 instances and AZ-b has 2 instances, the load will still be distributed 50% across each of the AZs</li>
<li>Enabling Cross-Zone load balancing allows the ELB to distribute incoming requests evenly across all the back-end instances, regardless of the AZ</li>
<li>Cross-zone load balancer reduces the need to maintain equivalent numbers of back-end instances in each Availability Zone, and improves application’s ability to handle the loss of one or more back-end instances.</li>
<li>It is still recommended to maintain approximately equivalent numbers of instances in each Availability Zone for higher fault tolerance.</li>
</ul></li>

<li><p><strong>Connection Draining</strong></p>

<ul>
<li>By default, if an registered EC2 instance with the ELB is deregistered or becomes unhealthy, the load balancer immediately closes the connection</li>
<li>Connection draining can help the load balancer to complete the in-flight requests made while keeping the existing connections open, and preventing any new requests being sent to the instances that are de-registering or unhealthy.</li>
<li>Connection draining helps perform maintenance such as deploying software upgrades or replacing back-end instances without affecting customers’ experience</li>
<li>Connection draining allows you to specify a maximum time (between 1 and 3,600 seconds and default 300 seconds) to keep the connections alive before reporting the instance as de-registered. Maximum timeout limit does not apply to connections to unhealthy instances.</li>
<li>If the instances are part of an Auto Scaling group and connection draining is enabled for your load balancer, Auto Scaling waits for the in-flight requests to complete, or for the maximum timeout to expire, before terminating instances due to a scaling event or health check replacement.</li>
</ul></li>

<li><p><strong>X-Forwarded Headers &amp; Proxy Protocol Support</strong></p>

<ul>
<li>When you use TCP or SSL for both front-end and back-end connections, your load balancer forwards requests to the back-end instances without modifying the request headers. If you enable Proxy Protocol, a human-readable header is added to the request header with connection information such as the source IP address, destination IP address, and port numbers. The header is then sent to the back-end instance as part of the request.</li>
<li>ELB provides X-Forwarded headers support to help back end servers track the same when using HTTP protocol

<ul>
<li><strong>X-Forwarded-For</strong> request header to help back end servers identify the IP address of a client when you use an HTTP or HTTPS load balancer.</li>
<li><strong>X-Forwarded-Proto</strong> request header to help back end servers identify the protocol (HTTP/S) that a client used to connect to the server</li>
<li><strong>X-Forwarded-Port</strong> request header to help back end servers identify the port that an HTTP or HTTPS load balancer uses to connect to the client.</li>
</ul></li>
<li>Before using Proxy Protocol, verify that your load balancer is not behind a <strong>proxy server with Proxy Protocol enabled</strong>. If Proxy Protocol is enabled on both the <strong>proxy server</strong> and the <strong>load balancer</strong>, the load balancer adds another header to the request, which already has a header from the proxy server.</li>
</ul></li>

<li><p><strong>Sticky Sessions (Session Affinity)</strong></p>

<ul>
<li>ELB can be configured to use sticky session feature (also called session affinity) which enables it to bind a user’s session to an instance and ensures all requests are sent to the same instance.</li>
<li>Stickiness remains for a period of time which can be controlled by the application’s session cookie, if one exists, or through cookie, named <strong>AWSELB</strong>, created through Elastic Load balancer.</li>
<li>Sticky sessions for ELB are disabled, by default.</li>
<li>Duration-Based Session Stickiness

<ul>
<li>Duration-Based Session Stickiness is maintained by ELB using a special cookie created to track the instance for each request to each listener.</li>
<li>When the load balancer receives a request, it first checks to see if this cookie is present in the request. If so, the request is sent to the instance specified in the cookie.</li>
<li>If there is no cookie, the ELB chooses an instance based on the existing load balancing algorithm and a cookie is inserted into the response for binding subsequent requests from the same user to that instance.</li>
<li>Stickiness policy configuration defines a cookie expiration, which establishes the duration of validity for each cookie. The cookie is automatically updated after its duration expires.</li>
</ul></li>
<li>Application-Controlled Session Stickiness

<ul>
<li>Load balancer uses a special cookie only to associate the session with the instance that handled the initial request, but follows the lifetime of the application cookie specified in the policy configuration.</li>
<li>Load balancer only inserts a new stickiness cookie if the application response includes a new application cookie. The load balancer stickiness cookie does not update with each request.</li>
<li>If the application cookie is explicitly removed or expires, the session stops being sticky until a new application cookie is issued.</li>
<li>If an instance fails or becomes unhealthy, the load balancer stops routing request to that instance, instead chooses a new healthy instance based on the existing load balancing algorithm. The load balancer treats the session as now “stuck” to the new healthy instance, and continues routing requests to that instance even if the failed instance comes back.</li>
</ul></li>
</ul></li>
</ul>
        </div>
        
    </div>
    
    
    <footer class="sticky-footer">
    <div class="container">
        <div class="text-center">
            <small>Copyright © Anand Vyas 2019</small>
        </div>
    </div>
</footer>

<a class="scroll-to-top rounded" href="#page-top">
    <i class="fa fa-angle-up"></i>
</a>


<script src="http://localhost:4000/js/popper.min.js"></script>
<script src="http://localhost:4000/js/bootstrap.min.js"></script>
<script src="http://localhost:4000/js/highlight.min.js"></script>
<script src="http://localhost:4000/js/moment.min.js"></script>
<script src="http://localhost:4000/js/clipboard.min.js"></script>

<script src="http://localhost:4000/js/jquery.easing.min.js"></script>

<script src="http://localhost:4000/js/sb-admin.js"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-108803266-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-108803266-1');
</script>
  </div>
<script data-no-instant>document.write('<script src="/livereload.js?port=4000&mindelay=10"></' + 'script>')</script></body>
</html>
