<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Apache htaccess configuration - Anand vyas</title>
    <meta content="Apache htaccess configuration - Anand vyas" property="og:title">
    <meta content="Linux, htaccess" name="keywords">
    <meta content="htaccess configuration" property="og:description">
    <meta name="author" content="Anand Vyas">

    
    <link href="http://anandvyas.in/css/bootstrap.min.css" rel="stylesheet">
    
    <link href="http://anandvyas.in/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    
    <link href="http://anandvyas.in/css/highlighter.css" rel="stylesheet">
    
    <link href="http://anandvyas.in/css/sb-admin.css" rel="stylesheet">
    <link href="http://anandvyas.in/css/about.css" rel="stylesheet">
</head>
<body class="fixed-nav sticky-footer bg-dark sidenav-toggled" id="page-top">
  
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top" id="mainNav">
    <a class="navbar-brand" href="http://anandvyas.in/">
        <img src="http://anandvyas.in/images/profile/logo.png" />
        <span>Anand vyas</span>
    </a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive"
        aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav navbar-sidenav">
            <li class="nav-item sidebar-profile text-center">
                <div class="profile-pic">
                    <img src="http://anandvyas.in/images/profile/avatar.jpg" alt="avatar">
                </div>
                <div class="profile-detail">
                    
                    <span>Solution Architect</span> 
                    <span>Cloud Architect</span> 
                    <span>DevOps</span> 
                    <span>Tech Lead</span> 
                </div>
            </li>
            
            <li class="nav-item sidebar-menu" data-toggle="tooltip" data-placement="right" title="Home">
                <a class="nav-link" href="http://anandvyas.in/">
                <i class="fa fa-fw fa fa-home"></i>
                <span class="nav-link-text">Home</span>
                </a>
            </li>
            
            <li class="nav-item sidebar-menu" data-toggle="tooltip" data-placement="right" title="About">
                <a class="nav-link" href="http://anandvyas.in/about">
                <i class="fa fa-fw fa fa-user-circle"></i>
                <span class="nav-link-text">About</span>
                </a>
            </li>
            
            <li class="nav-item sidebar-menu" data-toggle="tooltip" data-placement="right" title="Categories">
                <a class="nav-link" href="http://anandvyas.in/categories">
                <i class="fa fa-fw fa fa-dashboard"></i>
                <span class="nav-link-text">Categories</span>
                </a>
            </li>
            
            <li class="nav-item sidebar-menu" data-toggle="tooltip" data-placement="right" title="Tags">
                <a class="nav-link" href="http://anandvyas.in/tags">
                <i class="fa fa-fw fa fa-tags"></i>
                <span class="nav-link-text">Tags</span>
                </a>
            </li>
            
        </ul>
        <ul class="navbar-nav sidenav-social">
            
            <li><a href="#" target="_blank"><i class="fa fa-mobile"></i></a></li>
            
            <li><a href="mailto:anandvyas@live.com" target="_blank"><i class="fa fa-envelope"></i></a></li>
            
            <li><a href="https://twitter.com/anandvyaas" target="_blank"><i class="fa fa-twitter"></i></a></li>
            
            <li><a href="https://www.linkedin.com/in/anandvyaas" target="_blank"><i class="fa fa-linkedin"></i></a></li>
            
            <li><a href="https://www.instagram.com/anandvyaas" target="_blank"><i class="fa fa-instagram"></i></a></li>
            
            <li><a href="https://github.com/anandvyas" target="_blank"><i class="fa fa-github"></i></a></li>
            
            <li><a href="https://stackoverflow.com/users/8208060/anand-vyas" target="_blank"><i class="fa fa-stack-overflow"></i></a></li>
            
        </ul>
        <ul class="navbar-nav sidenav-toggler">
            <li class="nav-item">
                <a class="nav-link text-center" id="sidenavToggler">
            <i class="fa fa-fw fa-angle-left"></i>
            </a>
            </li>
        </ul>
        
        
    </div>
</nav>
  
  <div class="content-wrapper">
    <div class="container-fluid">
    


<ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="http://anandvyas.in/">Home</a></li>


    
    <li class="breadcrumb-item active"><a href='http://anandvyas.in/linux'>linux</a></li>
    
    


    
    <li class="breadcrumb-item active"><a href='http://anandvyas.in/linux/apache-htaccess'>apache-htaccess</a></li>
    
    


    

</ol>

        <div class="post">
            <h1>Apache htaccess configuration</h1>
            <span class="post-date">Thu, Apr 12, 2018</span>
            

<p>Htaccess (HyperText Access) is a configuration file that allows developers to overide the Apache webserver configuration at directory level.</p>

<h3 id="a-name-htaccess-enable-enable-htaccess-a"><a name="htaccess-enable">Enable .htaccess</a></h3>

<p>By default .htaccess is not enable, we have to change in httpd.conf (Apache) configuration file to for enable .htaccess</p>

<p>Replace <code>AllowOverride None</code> to  <code>AllowOverride All</code></p>

<p><strong>Examples:</strong></p>

<pre><code>&lt;Directory /var/www/html/example.com/public_html&gt;
    Options Indexes FollowSymLinks
    AllowOverride All
    Require all granted
&lt;/Directory&gt;
</code></pre>

<h3 id="a-name-htaccess-common-uses-common-uses-of-htaccess-a"><a name="htaccess-common-uses">Common Uses of .htaccess</a></h3>

<ul>
<li><a href="#htaccess-mod-rewrite">Mod_Rewrite</a></li>
<li><a href="#htaccess-authentication">Authentication</a></li>
<li><a href="#htaccess-custom-error-pages">Custom Error Pages</a></li>
<li><a href="#htaccess-mime-types">Mime Types</a></li>
<li><a href="#htaccess-ssi">SSI (Server Side Includes)</a></li>
</ul>

<h3 id="a-class-innerlink-name-htaccess-mod-rewrite-mod-rewrite-a"><a class="innerlink" name="htaccess-mod-rewrite">Mod_Rewrite</a></h3>

<p>Mod_rewrite module is use for rule-based rewrite engine, based on Perl Compatible Regular Expressions. All the URL rewrite commands follow the below pattern</p>

<blockquote>
<p>RewriteRule Pattern Substitution [OptionalFlags]</p>
</blockquote>

<p><strong>Examples:</strong></p>

<pre><code>RewriteRule ^products/([A-Za-z0-9-]+)/?$ results.php?products=$1 [NC]
</code></pre>

<h3 id="a-class-innerlink-name-htaccess-authentication-authentication-a"><a class="innerlink" name="htaccess-authentication">Authentication</a></h3>

<p>If we need to set additional permission to the specific area then we use .htaccess authentication</p>

<pre><code>AuthUserFile /usr/local/username/.htpasswd
AuthGroupFile /dev/null
AuthName &quot;Dialog box Title&quot;
AuthType Basic
Require valid-user
</code></pre>

<p><strong>Generating Htpasswd file</strong></p>

<pre><code>htpasswd -c /usr/local/username/.htpasswd anandvyas
</code></pre>

<p>After that its asking for New password and Re-type new password</p>

<h3 id="a-class-innerlink-name-htaccess-custom-error-pages-custom-error-pages-a"><a class="innerlink" name="htaccess-custom-error-pages">Custom Error Pages</a></h3>

<p>You can move the user if they have error on site</p>

<p><strong>Examples:</strong></p>

<ul>
<li>ErrorDocument 400 /400.html</li>
<li>ErrorDocument 401 /401.html</li>
<li>ErrorDocument 403 /403.html</li>
<li>ErrorDocument 404 /404.html</li>
<li>ErrorDocument 500 /500.html</li>
<li>ErrorDocument 502 /502.html</li>
<li>ErrorDocument 504 /504.html</li>
</ul>

<h3 id="a-class-innerlink-name-htaccess-mime-types-mime-types-a"><a class="innerlink" name="htaccess-mime-types">Mime Types</a></h3>

<p>MIME types set what a file is, or rather what file extensions refer to what file types. For example, a &lsquo;.html&rsquo; file extension refers to a HTML document, a &lsquo;.zip&rsquo; file extension refers to a ZIP archive file. The server needs to know this so it knows how to deal with the file.</p>

<ul>
<li>AddType text/html .html .htm</li>
<li>AddType text/plain .txt</li>
<li>AddType text/richtext .rtx</li>
<li>AddType text/tab-separated-values .tsv</li>
<li>AddType text/x-setext .etx</li>
<li>AddType text/x-server-parsed-html .shtml .sht</li>
<li>AddType application/macbinhex-40 .hqx</li>
<li>AddType application/netalivelink .nel</li>
<li>AddType application/netalive .net</li>
<li>AddType application/news-message-id</li>
<li>AddType application/news-transmission</li>
<li>AddType application/octet-stream .bin .exe</li>
<li>AddType application/oda .oda</li>
<li>AddType application/pdf .pdf</li>
<li>AddType application/postscript .ai .eps .ps</li>
<li>AddType application/remote-printing</li>
<li>AddType application/rtf .rtf</li>
<li>AddType application/slate</li>
<li>AddType application/zip .zip</li>
<li>AddType application/x-mif .mif</li>
<li>AddType application/wita</li>
<li>AddType application/wordperfect5.1</li>
<li>AddType application/x-csh .csh</li>
<li>AddType application/x-dvi .dvi</li>
<li>AddType application/x-hdf .hdf</li>
<li>AddType application/x-latex .latex</li>
<li>AddType application/x-netcdf .nc .cdf</li>
<li>AddType application/x-sh .sh</li>
<li>AddType application/x-tcl .tcl</li>
<li>AddType application/x-tex .tex</li>
<li>AddType application/x-texinfo .texinfo .texi</li>
<li>AddType application/x-troff .t .tr .roff</li>
<li>AddType application/x-troff-man .man</li>
<li>AddType application/x-troff-me .me</li>
<li>AddType application/x-troff-ms .ms</li>
<li>AddType application/x-wais-source .src</li>
<li>AddType application/x-bcpio .bcpio</li>
<li>AddType application/x-cpio .cpio</li>
<li>AddType application/x-gtar .gtar</li>
<li>AddType application/x-shar .shar</li>
<li>AddType application/x-sv4cpio .sv4cpio</li>
<li>AddType application/x-sv4crc .sv4crc</li>
<li>AddType application/x-tar .tar</li>
<li>AddType application/x-ustar .ustar</li>
<li>AddType application/x-director .dcr</li>
<li>AddType application/x-director .dir</li>
<li>AddType application/x-director .dxr</li>
<li>AddType application/x-onlive .sds</li>
<li>AddType application/x-httpd-cgi .cgi</li>
<li>AddType image/gif .gif .GIF</li>
<li>AddType image/ief .ief</li>
<li>AddType image/jpeg .jpeg .jpg .jpe .JPG</li>
<li>AddType image/tiff .tiff .tif</li>
<li>AddType image/x-cmu-raster .ras</li>
<li>AddType image/x-portable-anymap .pnm</li>
<li>AddType image/x-portable-bitmap .pbm</li>
<li>AddType image/x-portable-graymap .pgm</li>
<li>AddType image/x-portable-pixmap .ppm</li>
<li>AddType image/x-rgb .rgb</li>
<li>AddType image/x-xbitmap .xbm</li>
<li>AddType image/x-xpixmap .xpm</li>
<li>AddType image/x-xwindowdump .xwd</li>
<li>AddType audio/basic .au .snd</li>
<li>AddType audio/x-aiff .aif .aiff .aifc</li>
<li>AddType audio/x-wav .wav</li>
<li>AddType audio/x-pn-realaudio .ram</li>
<li>AddType audio/x-midi .mid</li>
<li>AddType video/mpeg .mpeg .mpg .mpe</li>
<li>AddType video/quicktime .qt .mov</li>
<li>AddType video/x-msvideo .avi</li>
<li>AddType video/x-sgi-movie .movie</li>
<li>AddType message/external-body</li>
<li>AddType message/news</li>
<li>AddType message/partial</li>
<li>AddType message/rfc822</li>
<li>AddType multipart/alternative</li>
<li>AddType multipart/appledouble</li>
<li>AddType multipart/digest</li>
<li>AddType multipart/mixed</li>
<li>AddType multipart/parallel</li>
<li>AddType x-world/x-vrml .wrl</li>
</ul>

<h3 id="a-class-innerlink-name-htaccess-ssi-ssi-server-side-includes-a"><a class="innerlink" name="htaccess-ssi">SSI (Server Side Includes)</a></h3>

<p>Your server parse only .html file but you want to parse .shtml also so in the case you need add server-parser</p>

<pre><code>AddHandler server-parsed .html
AddHandler server-parsed .shtml
AddHandler server-parsed .htm
</code></pre>

<h3 id="a-class-innerlink-name-htaccess-ssi-some-useful-snippets-a"><a class="innerlink" name="htaccess-ssi">Some useful Snippets</a></h3>

<blockquote>
<p>Disable or Enable Directory browsing</p>

<pre><code># disable directory browsing
Options All -Indexes
# enable directory browsing
Options All +Indexes
</code></pre>

<p>Change index file</p>

<pre><code>DirectoryIndex index.html index.cgi index.php
</code></pre>

<p>Remove the Need for www in Your URL</p>

<pre><code>RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST} ^www.anandvyas.in [NC]
RewriteRule ^(.*)$ http://anandvyas.in/$1 [L,R=301]
</code></pre>

<p>Redirect Browser to https</p>

<pre><code>RewriteEngine On
RewriteCond %{HTTPS} !on
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}
</code></pre>

<p>Force &ldquo;File Save As&rdquo; means to have force user to download file, not see in the browser</p>

<pre><code>AddType application/octet-stream .avi .mpg .mov .pdf .xls .mp4
</code></pre>

<p>Redirect mobile and tablets on different folders</p>

<pre><code>RewriteCond %{HTTP_USER_AGENT} ^.*iPad.*$
RewriteRule ^(.*)$ http://anandvyas.in/folderfortablets [R=301]
RewriteCond %{HTTP_USER_AGENT} ^.*Android.*$
RewriteRule ^(.*)$ http://anandvyas.in/folderfortablets [R=301]
</code></pre>

<p>301 Permanent Redirects</p>

<pre><code>Redirect 301 /olddirectory/file.html http://www.anandvyas.in/newdirectory/file.html
</code></pre>

<p>Browser Cache</p>

<pre><code># 1 WEEK 1 DAY
&lt;filesMatch “.(jpg|jpeg|png|gif|swf|ico)$”&gt;
Header set Cache-Control “max-age=691200, public”
&lt;/filesMatch&gt;

&lt;filesMatch “.(xml|txt|js)$”&gt;
Header set Cache-Control “max-age=691200, proxy-revalidate”
&lt;/filesMatch&gt;

&lt;filesMatch “.(html|htm|css|php)$”&gt;
Header set Cache-Control “max-age=691200, private, proxy-revalidate”
&lt;/filesMatch&gt;
</code></pre>

<p>Gzip Compression</p>

<pre><code># compress text, HTML, JavaScript, CSS, and XML
AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/xml
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE application/xml
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript
</code></pre>

<p>*<strong>Browser specific</strong></p>

<pre><code>BrowserMatch ^Mozilla/4 gzip-only-text/html
BrowserMatch ^Mozilla/4\.0[678] no-gzip
BrowserMatch \bMSIE !no-gzip !gzip-only-text/html
</code></pre>
</blockquote>

<p><br/></p>

<h3 id="a-class-innerlink-name-htaccess-mod-rewrite-cheat-sheet-mod-rewrite-cheat-sheet-a"><a class="innerlink" name="htaccess-mod-rewrite-cheat-sheet">mod_rewrite Cheat Sheet</a></h3>

<div class="text-center">
    <img class="img-responsive" src="http://anandvyas.in/images/linux/mod-rewrite.png" alt="Mod Rewrite" />
</div>
 

        </div>
        <div id="disqus_thread"></div>
<script>





(function() { 
var d = document, s = d.createElement('script');
s.src = 'https://anandvyas.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
                            
    </div>
    
    
    <footer class="sticky-footer">
    <div class="container">
        <div class="text-center">
            <small>Copyright © Anand Vyas 2018</small>
        </div>
    </div>
</footer>

<a class="scroll-to-top rounded" href="#page-top">
    <i class="fa fa-angle-up"></i>
</a>

<script src="http://anandvyas.in/js/jquery.min.js"></script>
<script src="http://anandvyas.in/js/popper.min.js"></script>
<script src="http://anandvyas.in/js/bootstrap.min.js"></script>
<script src="http://anandvyas.in/js/highlight.min.js"></script>
<script src="http://anandvyas.in/js/moment.min.js"></script>
<script src="http://anandvyas.in/js/clipboard.min.js"></script>

<script src="http://anandvyas.in/js/jquery.easing.min.js"></script>

<script src="http://anandvyas.in/js/sb-admin.js"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-108803266-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-108803266-1');
</script>
  </div>
<script data-no-instant>document.write('<script src="/livereload.js?port=1313&mindelay=10"></' + 'script>')</script></body>
</html>
